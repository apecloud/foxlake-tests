# Please put the directory 'cicd' to your bucket.
# This directory can be found under the tests direcotory.

statement ok
DROP DATABASE IF EXISTS test_encoding;

statement ok
CREATE DATABASE test_encoding;

statement ok
USE test_encoding;

statement ok
DROP TABLE IF EXISTS t_enc;

statement ok
create table t_enc (s varchar(255), encoding varchar(255));

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/Big5.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='Big5');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/CP936.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='CP936');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/GB18030.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='GB18030');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/GB2312.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='GB2312');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/GBK.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='GBK');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/EUC-JP.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='EUC-JP');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/EUC-KR.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='EUC-KR');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/IBM424.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='IBM424');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-2022-JP.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-2022-JP');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-2022-KR.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-2022-KR');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-1.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-1');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-2.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-2');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-5.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-5');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-6.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-6');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-7.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-7');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-8.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-8');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-9.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-9');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/ISO-8859-15.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='ISO-8859-15');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/KOI8-R.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='KOI8-R');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/Shift_JIS.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='Shift_JIS');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/UTF-8.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='UTF-8');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/UTF-16.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='UTF-16');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/UTF-16BE.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='UTF-16BE');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/UTF-16LE.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='UTF-16LE');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/UTF-32.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='UTF-32');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/UTF-32BE.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='UTF-32BE');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/UTF-32LE.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='UTF-32LE');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/windows-1250.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='windows-1250');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/windows-1251.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='windows-1251');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/windows-1252.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='windows-1252');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/windows-1253.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='windows-1253');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/windows-1254.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='windows-1254');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/windows-1255.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='windows-1255');

statement ok
COPY INTO t_enc FROM URI '{{.STORAGE_PROVIDER}}://{{.BUCKET}}/cicd/encoding/windows-1256.csv'
ENDPOINT = '{{.ENDPOINT}}'
CREDENTIALS = (ACCESS_KEY_ID='{{.ACCESS_KEY_ID}}', SECRET_ACCESS_KEY='{{.SECRET_ACCESS_KEY}}')
FILE_FORMAT = (TYPE='csv', FIELD_DELIMITER='|', OPTIONALLY_ENCLOSED='"', ENCODING='windows-1256');

hash-threshold 40

query TT rowsort
select s, encoding from t_enc;
----
Türkiye	ISO-8859-9
Türkiye	windows-1254
ÀÁÂÃÄÅÆÇÈÉÊË	ISO-8859-1
ĂČĐĚŇŘŠŤŮŽ	windows-1250
ąęćłńśźż	ISO-8859-2
Ελλάδα	ISO-8859-7
Ελλάδα	windows-1253
Россия	ISO-8859-5
Россия	KOI8-R
Россия	windows-1251
ישראל	IBM424
ישראל	ISO-8859-8
ישראל	windows-1255
العربية	ISO-8859-6
العربية	windows-1256
€ŠšŽžŒœŸ	ISO-8859-15
€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™›œžŸ	windows-1252
にほん	EUC-JP
にほん	ISO-2022-JP
にほん	Shift_JIS
中国	CP936
中国	GB18030
中国	GB2312
中国	GBK
中国	UTF-16
中国	UTF-16BE
中国	UTF-16LE
中国	UTF-32
中国	UTF-32BE
中国	UTF-32LE
中国	UTF-8
中國	Big5
한국	EUC-KR
한국	ISO-2022-KR

statement ok
DROP DATABASE IF EXISTS test_encoding;